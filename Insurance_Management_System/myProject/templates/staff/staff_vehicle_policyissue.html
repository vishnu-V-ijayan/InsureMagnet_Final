{% comment %} {% extends "customer_base.html" %} {% endcomment %}
{% comment %} <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"> {% endcomment %}
{% block body %}
<body>
<!-- customer_vehicle_policyissue.html -->
<div class="container mt-3">
    <div class="row">
        <!-- First Column, split into top and bottom -->
        <div class="col-md-4">
            <!-- Top section - Customer Details -->
            <div class="card">
                <div class="card-header">
                    <strong>Customer Details</strong>
                </div>
                <div class="card-body">
                    {% if customer %}
                    <h5 class="card-title">Customer ID: {{ customer.id }}</h5>
                    <p class="card-text">Customer Name: {{ customer.first_name }} {{ customer.last_name }}</p>
                    {% else %}
                    <p class="card-text">No Customer Details Available</p>
                    {% endif %}
                </div>
            </div>

            <!-- Bottom section - Registered Office Details -->
            <div class="card mt-3">
                <div class="card-header">
                    <strong>Registered Office Details</strong>
                </div>
                <div class="card-body table-responsive">
                    {% if offices %}
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th scope="col">Office ID</th>
                                <th scope="col">Address</th>
                                <th scope="col">Place</th>
                                <th scope="col">Location</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for office in offices %}
                            <tr>
                                <td>{{ office.officeid }}</td>
                                <td>{{ office.address }}</td>
                                <td>{{ office.place }}</td>
                                <td>{{ office.location }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p>No Office Registered...</p>
                    {% endif %}
                </div>
            </div>
        </div>

       <!-- Second Column - Vehicle Details -->
<div class="col-md-4">
    <div class="card">
        <div class="card-header">
            <strong>Vehicle Details</strong>
        </div>
        <div class="card-body">
            <form method="post" action='{% url "register_policy" %}' enctype="multipart/form-data" name="form2" onsubmit="return validateForm()">
                {% csrf_token %}
                <div class="table-responsive">
                    <table class="table table-sm">
                        <tr>
                            <td>Vehicle No</td>
                            <td>
                                <input name="t2" type="text" id="t2" pattern="^[A-Z]{2} \d{2} [A-Z] \d{4}$" title="Format should be AA 00 A 0000" maxlength="12" required>
                            </td>
                        </tr>
                        <tr>
                            <td>Vehicle Value</td>
                            <td><input name="t3" type="text" id="t3" pattern="\d+" title="Only numeric values are allowed." required></td>
                        </tr>
                        <tr>
                            <td>Select Plan</td>
                            <td>
                                <select name="t4" id="t4" required>
                                    <option value="">Select</option>
                                    {% for plan in plans %}
                                        <option value="{{ plan.id }}">{{ plan.id }} - {{ plan.PType }}</option>
                                    {% endfor %}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Engine No.</td>
                            <td><input name="t5" type="text" id="t5" pattern="\d+" title="Only numeric values are allowed." required></td>
                        </tr>
                        <tr>
                            <td>Chassis No.</td>
                            <td><input name="t6" type="text" id="t6" pattern="\d+" title="Only numeric values are allowed." required></td>
                        </tr>
                        <tr>
                            <td>Vehicle Size</td>
                            <td><input name="t7" type="text" id="t7" required></td>
                        </tr>
                        <tr>
                            <td>Company</td>
                            <td>
                                <select name="t8" id="t8" required>
                                    <option value="">Select</option>
                                    <option value="Maruthi">Maruthi</option>
                                    <option value="Hyundai">Hyundai</option>
                                    <option value="Honda">Honda</option>
                                    <option value="Toyota">Toyota</option>
                                    <option value="Kia">Kia</option>
                                    <option value="Bajaj">Bajaj</option>
                                    <option value="Tata">Tata</option>
                                    <option value="Renault">Renault</option>
                                    <option value="Leyland">Leyland</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Power (Cubic Capacity)</td>
                            <td><input name="t9" type="text" id="t9" pattern="\d+" title="Only numeric values are allowed." required> CC</td>
                        </tr>
                        <tr>
                            <td>Manufacturing Year</td>
                            <td>
                                <select name="t10" id="t10" required>
                                    <option value="">Select</option>
                                    {% for year in years %}
                                        <option value="{{ year }}">{{ year }}</option>
                                    {% endfor %}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Vehicle Photo</td>
                            <td><input type="file" name="file" required></td>
                        </tr>
                        <tr>
                            <td>Vehicle Type</td>
                            <td>
                                <select name="t11" id="t11" required>
                                    <option value="">Select</option>
                                    <option>Two wheeler</option>
                                    <option>Three wheeler</option>
                                    <option>Four wheeler</option>
                                    <option>Heavy</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Select Office ID</td>
                            <td>
                                <select name="t12" id="t12" required>
                                    <option value="">Select an Office</option>
                                    {% for office in offices %}
                                        <option value="{{ office.officeid }}">{{ office.officeid }} - {{ office.address }}</option>
                                    {% endfor %}
                                </select>
                            </td>
                        </tr>
                    </table>
                </div>
                <input type="submit" name="Submit" value="Register Policy" class="btn btn-primary">
            </form>
        </div>
    </div>
</div>

<script>
function validateForm() {
    var vehicleNo = document.getElementById("t2").value;
    var regexVehicleNo = /^[A-Z]{2} \d{2} [A-Z] \d{4}$/;
    if (!regexVehicleNo.test(vehicleNo)) {
        alert("Vehicle Number must be in the format AA 00 A 0000.");
        return false;
    }
    return true;
}
</script>

        <!-- Third Column - Plan Details -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <strong>Policy Plan Details</strong>
                </div>
                <div class="card-body table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Plan ID</th>
                                <th>Premium Type</th>
                                <th>Premium Percentage</th>
                                <th>Specifications</th>
                                <th>Depreciation</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for plan in plans %}
                            <tr>
                                <td>{{ plan.id }}</td>
                                <td>{{ plan.PType }}</td>
                                <td>{{ plan.Ppercentage }}%</td>
                                <td>{{ plan.sp }}</td>
                                <td>{{ plan.depreciation }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
{% endblock body %}
